<div class="container">
  <div #message class="message" [ngClass]="wasSavedCorrectly ? 'message-success' : 'message-error'">
    <p *ngIf="wasSavedCorrectly else error" >Poprawnie zapisano dane kampanii</p>
    <ng-template #error>
      <p>Nie udało się zapisać danych kampanii</p>
    </ng-template>
    <button kendoButton [icon]="'close'" [look]="'flat'" (click)="closeMessage()"></button>
  </div>

  <div class="campaign-info">
    <div class="campaign-header">
      <h1>{{name || 'Nowa kampania'}}</h1>

      <kendo-buttongroup>
        <button kendoButton
                [icon]="'undo'"
                [primary]="true"
                (click)="back()">
                Powrót
        </button>
        <button kendoButton
                [icon]="isSaving ? 'loading' : 'save'"
                [primary]="true"
                (click)="save()"
                [disabled]="!name">
                Zapisz
        </button>
        <button kendoButton
                [icon]="'save'"
                [primary]="true"
                disabled="true">
                Zapisz i wyślij
        </button>
      </kendo-buttongroup>
    </div>

    <div class="info-wrapper">
      <kendo-panelbar [selectable]="false">
        <kendo-panelbar-item [selected]="true" title="" expanded="true">
          <ng-template kendoPanelBarItemTitle>
            <h3>Podstawowe</h3>
          </ng-template>

          <ng-template kendoPanelBarContent>
            <div class="input-basic-data-container">
              <label>Nazwa</label>
              <input [(ngModel)]="name" type="text" class="k-textbox" name="name" [ngStyle]="!name ? {'border-color': 'red'} : {}">

              <div class="checkboxes-wrapper">
                <div>
                  <label>Tel. stac.</label>
                  <kendo-switch [(ngModel)]="flgTelStac" [onLabel]="'Tak'" [offLabel]="'Nie'"></kendo-switch>
                </div>

                <div>
                  <label>Tel. kom.</label>
                  <kendo-switch [(ngModel)]="flgGSM" [onLabel]="'Tak'" [offLabel]="'Nie'"></kendo-switch>
                </div>

                <div>
                  <label>Tel. os. kon.</label>
                  <kendo-switch [(ngModel)]="flgTelOsKon" [onLabel]="'Tak'" [offLabel]="'Nie'"></kendo-switch>
                </div>
              </div>
            </div>
          </ng-template>
        </kendo-panelbar-item>
      </kendo-panelbar>
    </div>

    <div class="info-wrapper">
      <kendo-panelbar [selectable]="false">
        <kendo-panelbar-item title="" expanded="true">
          <ng-template kendoPanelBarItemTitle>
            <h3>Notatka</h3>
          </ng-template>

          <ng-template kendoPanelBarContent>
            <div class="note-container">
              <textarea [(ngModel)]="note" kendoTextBox name="note"></textarea>
            </div>
          </ng-template>
        </kendo-panelbar-item>
      </kendo-panelbar>
    </div>
  </div>

  <div class="cases-container" *ngIf="id !== 0">
    <kendo-panelbar [selectable]="false">
      <kendo-panelbar-item title="" expanded="true">
        <ng-template kendoPanelBarItemTitle>
          <div class="cases-container-header">
            <h3>Zlecenia</h3>
            <button kendoButton
                    [icon]="'add'"
                    [primary]="true"
                    [look]="'outline'"
                    (click)="addCases()">
                    Dodaj
            </button>
          </div>
        </ng-template>

        <ng-template kendoPanelBarContent>
          <div class="cases-grid-container">
            <kendo-grid *ngIf="campaignCases else loading"
            [kendoGridBinding]="campaignCases"
            [pageable]="true"
            [pageSize]="20"
            [sortable]="true"
            >
              <kendo-grid-column title="Akcje" >
                <ng-template kendoGridCellTemplate let-dataItem>
                  <div class="actions">
                    <button kendoButton
                            [primary]="true"
                            [look]="'bare'"
                            [icon]="'trash'"
                            (click)="removeCase(dataItem.Id, dataItem.NumerRepertorium)"></button>
                  </div>
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column field="NumerRepertorium" title="Nr" width="150">
              </kendo-grid-column>
              <kendo-grid-column field="SymbolWlasny" title="Symbol własny" width="150">
              </kendo-grid-column>
              <kendo-grid-column title="Data wpływu" width="150">
                <ng-template kendoGridCellTemplate let-dataItem>
                  {{dataItem.DataWplywu | date:'y-M-d'}}
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column field="Klient" title="Klient" width="150">
              </kendo-grid-column>
              <kendo-grid-column field="StronaPrzeciwna" title="Strona przeciwna" width="150">
              </kendo-grid-column>
              <kendo-grid-column field="Saldo" title="Saldo" width="100">
              </kendo-grid-column>
              <kendo-grid-column field="Pakiet" title="Pakiet" width="120">
              </kendo-grid-column>
            </kendo-grid>
            <ng-template #loading>
              <kambit-loading-data></kambit-loading-data>
            </ng-template>
          </div>
        </ng-template>
      </kendo-panelbar-item>
    </kendo-panelbar>

    <div kendoDialogContainer></div>
  </div>
</div>

